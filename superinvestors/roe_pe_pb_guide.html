<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>股票投资黄金公式：ROE × PE ≈ PB + 杜邦框架完全指南</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.2rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .formula-box {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
        }

        .content-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            padding-left: 20px;
        }

        h3 {
            color: #34495e;
            font-size: 1.3rem;
            margin: 20px 0 10px 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8efff 100%);
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .metric-card.roe {
            border-left-color: #e74c3c;
        }

        .metric-card.pe {
            border-left-color: #3498db;
        }

        .metric-card.pb {
            border-left-color: #2ecc71;
        }

        .metric-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .metric-definition {
            color: #7f8c8d;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .range-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .range-table th,
        .range-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
        }

        .range-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
        }

        .high { background-color: #ffebee; color: #c62828; }
        .medium { background-color: #e8f5e8; color: #2e7d32; }
        .low { background-color: #fff3e0; color: #ef6c00; }

        .combination-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .combination-card {
            border-radius: 15px;
            padding: 25px;
            color: white;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .combination-card:hover {
            transform: translateY(-5px);
        }

        .combination-card.excellent {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .combination-card.value {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .combination-card.growth {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .combination-card.warning {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .example-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #e17055;
        }

        .tips-box {
            background: linear-gradient(135deg, #81ecec 0%, #74b9ff 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #2d3436;
        }

        .calculator-section {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
        }

        .calculator-input {
            display: inline-block;
            margin: 10px;
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1rem;
            width: 120px;
            text-align: center;
        }

        .calculator-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.3s ease;
        }

        .calculator-button:hover {
            transform: translateY(-2px);
        }

        .result-display {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .metrics-grid,
            .combination-grid {
                grid-template-columns: 1fr;
            }

            .calculator-input {
                width: 100px;
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📈 股票投资黄金公式</h1>
            <p>掌握 ROE × PE ≈ PB 关系 + 杜邦框架分析，成为价值投资高手</p>
            <div class="formula-box">
                ROE × PE ≈ PB
            </div>
            <p>一个公式看懂股票估值的奥秘，深入解析ROE构成</p>
        </div>

        <div class="content-section">
            <h2>🔍 三大核心指标解析</h2>
            <div class="metrics-grid">
                <div class="metric-card roe">
                    <div class="metric-title">ROE (净资产收益率)</div>
                    <div class="metric-definition">衡量公司运用股东资金的盈利效率</div>
                    <p><strong>计算公式：</strong>净利润 ÷ 股东权益</p>
                    <p><strong>意义：</strong>ROE越高，说明管理层越会"花钱赚钱"</p>
                </div>

                <div class="metric-card pe">
                    <div class="metric-title">PE (市盈率)</div>
                    <div class="metric-definition">股价相对于每股收益的倍数</div>
                    <p><strong>计算公式：</strong>股价 ÷ 每股收益</p>
                    <p><strong>意义：</strong>反映投资者愿意为每元收益付出的代价</p>
                </div>

                <div class="metric-card pb">
                    <div class="metric-title">PB (市净率)</div>
                    <div class="metric-definition">股价相对于每股净资产的倍数</div>
                    <p><strong>计算公式：</strong>股价 ÷ 每股净资产</p>
                    <p><strong>意义：</strong>反映股票相对于账面价值的溢价程度</p>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>� 杜邦框架：ROE深度分析</h2>
            <div class="formula-box" style="background: linear-gradient(45deg, #6c5ce7, #a29bfe);">
                ROE = 净利润率 × 资产周转率 × 权益乘数
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card" style="border-left-color: #6c5ce7;">
                    <div class="metric-title">净利润率</div>
                    <div class="metric-definition">反映公司的盈利能力</div>
                    <p><strong>计算公式：</strong>净利润 ÷ 营业收入</p>
                    <p><strong>意义：</strong>每元收入能产生多少净利润</p>
                    <p><strong>提升方式：</strong>提高毛利率、控制费用率</p>
                </div>

                <div class="metric-card" style="border-left-color: #a29bfe;">
                    <div class="metric-title">资产周转率</div>
                    <div class="metric-definition">反映公司的运营效率</div>
                    <p><strong>计算公式：</strong>营业收入 ÷ 总资产</p>
                    <p><strong>意义：</strong>每元资产能产生多少收入</p>
                    <p><strong>提升方式：</strong>提高资产使用效率、减少闲置资产</p>
                </div>

                <div class="metric-card" style="border-left-color: #fd79a8;">
                    <div class="metric-title">权益乘数</div>
                    <div class="metric-definition">反映公司的财务杠杆</div>
                    <p><strong>计算公式：</strong>总资产 ÷ 股东权益</p>
                    <p><strong>意义：</strong>财务杠杆的大小</p>
                    <p><strong>注意事项：</strong>过高增加财务风险</p>
                </div>
            </div>

            <div class="tips-box" style="background: linear-gradient(135deg, #dda0dd 0%, #98fb98 100%);">
                <h3>🎯 杜邦框架的应用价值</h3>
                <p><strong>1. 诊断ROE变化原因：</strong>明确是盈利能力、运营效率还是财务杠杆导致的变化</p>
                <p><strong>2. 行业对比分析：</strong>不同行业ROE构成差异很大，便于横向比较</p>
                <p><strong>3. 投资策略制定：</strong>根据三要素强弱选择相应投资策略</p>
                <p><strong>4. 风险控制：</strong>识别过度依赖杠杆的高ROE风险</p>
            </div>

            <table class="range-table">
                <thead>
                    <tr>
                        <th>杜邦要素</th>
                        <th>优秀标准</th>
                        <th>一般标准</th>
                        <th>行业特征</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>净利润率</strong></td>
                        <td class="high">&gt; 10%</td>
                        <td class="medium">5% - 10%</td>
                        <td>软件&gt;制造&gt;零售</td>
                    </tr>
                    <tr>
                        <td><strong>资产周转率</strong></td>
                        <td class="high">&gt; 1.5</td>
                        <td class="medium">0.8 - 1.5</td>
                        <td>零售&gt;制造&gt;重资产</td>
                    </tr>
                    <tr>
                        <td><strong>权益乘数</strong></td>
                        <td class="medium">2 - 3</td>
                        <td class="low">1.5 - 2</td>
                        <td>银行&gt;地产&gt;一般行业</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-box">
                <h3>📋 杜邦分析实例</h3>
                <p><strong>公司A：</strong>ROE 18% = 净利润率 6% × 资产周转率 1.5 × 权益乘数 2.0</p>
                <p><strong>分析：</strong>盈利能力一般，运营效率较好，财务杠杆适中，整体健康</p>
                <br>
                <p><strong>公司B：</strong>ROE 18% = 净利润率 3% × 资产周转率 2.0 × 权益乘数 3.0</p>
                <p><strong>分析：</strong>盈利能力较弱，运营效率很好，但过度依赖杠杆，风险较高</p>
                <br>
                <p><strong>投资建议：</strong>相同ROE下，优选公司A这种更健康的ROE构成</p>
            </div>
        </div>

        <div class="content-section">
            <h2>�📊 量化标准与合理区间</h2>
            <table class="range-table">
                <thead>
                    <tr>
                        <th>指标</th>
                        <th>低估值</th>
                        <th>合理区间</th>
                        <th>高估值</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ROE</strong></td>
                        <td class="low">&lt; 10%</td>
                        <td class="medium">10% - 20%</td>
                        <td class="high">&gt; 20%</td>
                    </tr>
                    <tr>
                        <td><strong>PE</strong></td>
                        <td class="low">&lt; 10倍</td>
                        <td class="medium">10 - 20倍</td>
                        <td class="high">&gt; 25倍</td>
                    </tr>
                    <tr>
                        <td><strong>PB</strong></td>
                        <td class="low">&lt; 1倍</td>
                        <td class="medium">1 - 2倍</td>
                        <td class="high">&gt; 3倍</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="content-section">
            <h2>🎯 四种经典投资组合</h2>
            <div class="combination-grid">
                <div class="combination-card excellent">
                    <h3>🌟 优质成长型</h3>
                    <p><strong>ROE:</strong> 15-25%</p>
                    <p><strong>PE:</strong> 15-20倍</p>
                    <p><strong>PB:</strong> 2-3倍</p>
                    <p>业绩优秀，估值合理，适合长期持有</p>
                </div>

                <div class="combination-card value">
                    <h3>💎 价值投资型</h3>
                    <p><strong>ROE:</strong> 10-15%</p>
                    <p><strong>PE:</strong> 8-15倍</p>
                    <p><strong>PB:</strong> 0.8-2倍</p>
                    <p>被低估的优质资产，安全边际高</p>
                </div>

                <div class="combination-card growth">
                    <h3>🚀 高成长型</h3>
                    <p><strong>ROE:</strong> 20%+</p>
                    <p><strong>PE:</strong> 20-30倍</p>
                    <p><strong>PB:</strong> 4-6倍</p>
                    <p>高增长高估值，需要业绩持续兑现</p>
                </div>

                <div class="combination-card warning">
                    <h3>⚠️ 风险警告型</h3>
                    <p><strong>ROE:</strong> &lt;10%</p>
                    <p><strong>PE:</strong> &gt;20倍</p>
                    <p><strong>PB:</strong> &gt;2倍</p>
                    <p>高估值低回报，泡沫风险大</p>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>🧮 实时计算器</h2>
            <div class="calculator-section">
                <h3>输入数据，立即分析估值合理性</h3>
                <div>
                    <input type="number" id="roeInput" class="calculator-input" placeholder="ROE (%)" step="0.1">
                    <span style="font-size: 1.5rem; margin: 0 10px;">×</span>
                    <input type="number" id="peInput" class="calculator-input" placeholder="PE (倍)" step="0.1">
                    <span style="font-size: 1.5rem; margin: 0 10px;">=</span>
                    <input type="number" id="pbInput" class="calculator-input" placeholder="PB (倍)" step="0.1">
                </div>
                <button class="calculator-button" onclick="calculateAndAnalyze()">📊 分析估值</button>
                
                <h3 style="margin-top: 30px;">杜邦框架分析</h3>
                <div style="margin: 20px 0;">
                    <input type="number" id="netProfitMargin" class="calculator-input" placeholder="净利润率 (%)" step="0.1">
                    <span style="font-size: 1.5rem; margin: 0 10px;">×</span>
                    <input type="number" id="assetTurnover" class="calculator-input" placeholder="资产周转率" step="0.1">
                    <span style="font-size: 1.5rem; margin: 0 10px;">×</span>
                    <input type="number" id="equityMultiplier" class="calculator-input" placeholder="权益乘数" step="0.1">
                    <span style="font-size: 1.5rem; margin: 0 10px;">=</span>
                    <span id="dupontResult" style="font-size: 1.2rem; font-weight: bold; color: #2c3e50;">ROE</span>
                </div>
                <button class="calculator-button" onclick="analyzeDupont()">🔬 杜邦分析</button>
                
                <div id="result" class="result-display" style="display: none;"></div>
                <div id="dupontAnalysis" class="result-display" style="display: none;"></div>
            </div>
        </div>

        <div class="content-section">
            <h2>💡 实战应用技巧</h2>
            <div class="tips-box">
                <h3>🎯 选股策略建议</h3>
                <p><strong>1. 优先选择：</strong>ROE > 15%，PE < 20倍，PB < 3倍的股票</p>
                <p><strong>2. 避开陷阱：</strong>ROE < 10%但PE > 20倍的高估值低效率股票</p>
                <p><strong>3. 挖掘价值：</strong>关注PB < 1倍但ROE逐步改善的困境反转股</p>
                <p><strong>4. 行业对比：</strong>同行业内比较这三个指标更有意义</p>
                <p><strong>5. 趋势分析：</strong>关注指标的变化趋势，而非单一时点数据</p>
            </div>
        </div>

        <div class="content-section">
            <div class="example-box">
                <h3>📋 案例分析：某科技股</h3>
                <p><strong>数据：</strong>ROE 17%，PE 60倍，PB 10倍</p>
                <p><strong>验证：</strong>17% × 60 = 10.2 ≈ 10 ✓（数据一致）</p>
                <p><strong>分析：</strong>ROE表现良好，但PE和PB严重高估，属于高风险投资</p>
                <p><strong>建议：</strong>等待估值回归合理区间再考虑介入，或设定严格止损</p>
            </div>
        </div>

        <div class="content-section">
            <h2>🎓 总结要点</h2>
            <p>掌握 <strong>ROE × PE ≈ PB</strong> 这个黄金公式，你就拥了一把打开价值投资大门的钥匙。记住：</p>
            <br>
            <p>✅ <strong>ROE看效率</strong> - 公司赚钱能力的核心指标</p>
            <p>✅ <strong>PE看预期</strong> - 市场对未来的信心程度</p>
            <p>✅ <strong>PB看安全</strong> - 投资的安全边际所在</p>
            <p>✅ <strong>组合看价值</strong> - 三者结合才能全面评估</p>
            <br>
            <p><strong>🔬 杜邦框架精髓：</strong></p>
            <p>✅ <strong>净利润率</strong> - 反映盈利能力，关注成本控制</p>
            <p>✅ <strong>资产周转率</strong> - 反映运营效率，关注资产利用</p>
            <p>✅ <strong>权益乘数</strong> - 反映财务杠杆，关注风险控制</p>
            <p>✅ <strong>ROE分解</strong> - 诊断ROE构成，识别改善方向</p>
            <br>
            <p>投资路上，理性分析永远胜过情绪决策。用数据说话，让价值投资成为你的投资利器！</p>
        </div>
    </div>

    <script>
        function calculateAndAnalyze() {
            const roe = parseFloat(document.getElementById('roeInput').value);
            const pe = parseFloat(document.getElementById('peInput').value);
            const pb = parseFloat(document.getElementById('pbInput').value);
            
            if (!roe || !pe || !pb) {
                alert('请输入完整的ROE、PE和PB数据');
                return;
            }
            
            const calculated = (roe / 100) * pe;
            const difference = Math.abs(calculated - pb);
            const resultDiv = document.getElementById('result');
            
            let analysis = '';
            let riskLevel = '';
            let color = '';
            
            // 验证公式
            if (difference <= 0.5) {
                analysis += `✅ 数据验证通过：${(roe/100*pe).toFixed(2)} ≈ ${pb}<br>`;
            } else {
                analysis += `❌ 数据异常：理论值${calculated.toFixed(2)}，实际PB${pb}<br>`;
            }
            
            // ROE分析
            if (roe >= 20) {
                analysis += `🟢 ROE ${roe}%：盈利效率优秀<br>`;
            } else if (roe >= 10) {
                analysis += `🟡 ROE ${roe}%：盈利效率合理<br>`;
            } else {
                analysis += `🔴 ROE ${roe}%：盈利效率偏低<br>`;
            }
            
            // PE分析
            if (pe >= 25) {
                analysis += `🔴 PE ${pe}倍：估值过高，风险较大<br>`;
                riskLevel = '高风险';
                color = '#e74c3c';
            } else if (pe >= 10) {
                analysis += `🟡 PE ${pe}倍：估值合理区间<br>`;
            } else {
                analysis += `🟢 PE ${pe}倍：估值偏低，可能存在机会<br>`;
            }
            
            // PB分析
            if (pb >= 3) {
                analysis += `🔴 PB ${pb}倍：市净率过高<br>`;
                if (!riskLevel) {
                    riskLevel = '高风险';
                    color = '#e74c3c';
                }
            } else if (pb >= 1) {
                analysis += `🟡 PB ${pb}倍：市净率合理<br>`;
            } else {
                analysis += `🟢 PB ${pb}倍：可能被低估<br>`;
            }
            
            // 综合判断
            if (roe >= 15 && pe <= 20 && pb <= 3) {
                analysis += `<br>🌟 <strong>投资建议：优质投资标的</strong>`;
                if (!color) color = '#27ae60';
            } else if (roe >= 10 && pe <= 15 && pb <= 2) {
                analysis += `<br>💎 <strong>投资建议：价值投资机会</strong>`;
                if (!color) color = '#3498db';
            } else if (pe >= 25 || pb >= 3) {
                analysis += `<br>⚠️ <strong>投资建议：高估值高风险，建议谨慎</strong>`;
                color = '#e74c3c';
            } else {
                analysis += `<br>🤔 <strong>投资建议：需要深入分析</strong>`;
                if (!color) color = '#f39c12';
            }
            
            resultDiv.innerHTML = analysis;
            resultDiv.style.display = 'block';
            resultDiv.style.borderLeft = `5px solid ${color}`;
        }
        
        function analyzeDupont() {
            const netProfitMargin = parseFloat(document.getElementById('netProfitMargin').value);
            const assetTurnover = parseFloat(document.getElementById('assetTurnover').value);
            const equityMultiplier = parseFloat(document.getElementById('equityMultiplier').value);
            
            if (!netProfitMargin || !assetTurnover || !equityMultiplier) {
                alert('请输入完整的杜邦框架数据');
                return;
            }
            
            const calculatedROE = (netProfitMargin / 100) * assetTurnover * equityMultiplier;
            const resultSpan = document.getElementById('dupontResult');
            const analysisDiv = document.getElementById('dupontAnalysis');
            
            resultSpan.innerHTML = `${(calculatedROE * 100).toFixed(2)}%`;
            
            let analysis = `<h4>🔬 杜邦框架深度分析</h4>`;
            analysis += `<p><strong>计算结果：</strong>ROE = ${netProfitMargin}% × ${assetTurnover} × ${equityMultiplier} = ${(calculatedROE * 100).toFixed(2)}%</p><br>`;
            
            // 净利润率分析
            if (netProfitMargin >= 10) {
                analysis += `🟢 <strong>净利润率 ${netProfitMargin}%：</strong>盈利能力优秀，成本控制良好<br>`;
            } else if (netProfitMargin >= 5) {
                analysis += `🟡 <strong>净利润率 ${netProfitMargin}%：</strong>盈利能力合理，有提升空间<br>`;
            } else {
                analysis += `🔴 <strong>净利润率 ${netProfitMargin}%：</strong>盈利能力偏弱，需关注成本控制<br>`;
            }
            
            // 资产周转率分析
            if (assetTurnover >= 1.5) {
                analysis += `🟢 <strong>资产周转率 ${assetTurnover}：</strong>运营效率很高，资产利用充分<br>`;
            } else if (assetTurnover >= 0.8) {
                analysis += `🟡 <strong>资产周转率 ${assetTurnover}：</strong>运营效率合理，可继续优化<br>`;
            } else {
                analysis += `🔴 <strong>资产周转率 ${assetTurnover}：</strong>运营效率偏低，资产利用不充分<br>`;
            }
            
            // 权益乘数分析
            if (equityMultiplier >= 3) {
                analysis += `🔴 <strong>权益乘数 ${equityMultiplier}：</strong>财务杠杆过高，存在财务风险<br>`;
            } else if (equityMultiplier >= 2) {
                analysis += `🟡 <strong>权益乘数 ${equityMultiplier}：</strong>财务杠杆适中，杠杆使用合理<br>`;
            } else {
                analysis += `🟢 <strong>权益乘数 ${equityMultiplier}：</strong>财务杠杆保守，财务安全性高<br>`;
            }
            
            // ROE质量评估
            analysis += `<br><h4>📊 ROE质量评估</h4>`;
            
            const profitabilityScore = netProfitMargin >= 10 ? 3 : (netProfitMargin >= 5 ? 2 : 1);
            const efficiencyScore = assetTurnover >= 1.5 ? 3 : (assetTurnover >= 0.8 ? 2 : 1);
            const leverageScore = equityMultiplier <= 2 ? 3 : (equityMultiplier <= 3 ? 2 : 1);
            const totalScore = profitabilityScore + efficiencyScore + leverageScore;
            
            if (totalScore >= 8) {
                analysis += `🌟 <strong>ROE质量：优秀</strong> - 三个维度均表现良好，ROE质量很高<br>`;
            } else if (totalScore >= 6) {
                analysis += `🟡 <strong>ROE质量：良好</strong> - 大部分维度表现不错，有一定提升空间<br>`;
            } else {
                analysis += `🔴 <strong>ROE质量：一般</strong> - 多个维度需要改善，ROE可持续性存疑<br>`;
            }
            
            // 改善建议
            analysis += `<br><h4>💡 改善建议</h4>`;
            if (profitabilityScore === 1) {
                analysis += `• <strong>提升盈利能力：</strong>优化产品结构、提高毛利率、控制期间费用<br>`;
            }
            if (efficiencyScore === 1) {
                analysis += `• <strong>提升运营效率：</strong>加快存货周转、优化应收账款管理、提高产能利用率<br>`;
            }
            if (leverageScore === 1) {
                analysis += `• <strong>优化资本结构：</strong>降低财务杠杆、改善现金流、增强财务稳定性<br>`;
            }
            
            analysisDiv.innerHTML = analysis;
            analysisDiv.style.display = 'block';
            analysisDiv.style.borderLeft = '5px solid #6c5ce7';
        }
        
        // 实时更新杜邦ROE计算结果
        function updateDupontResult() {
            const netProfitMargin = parseFloat(document.getElementById('netProfitMargin').value) || 0;
            const assetTurnover = parseFloat(document.getElementById('assetTurnover').value) || 0;
            const equityMultiplier = parseFloat(document.getElementById('equityMultiplier').value) || 0;
            
            if (netProfitMargin && assetTurnover && equityMultiplier) {
                const calculatedROE = (netProfitMargin / 100) * assetTurnover * equityMultiplier;
                document.getElementById('dupontResult').innerHTML = `${(calculatedROE * 100).toFixed(2)}%`;
            } else {
                document.getElementById('dupontResult').innerHTML = 'ROE';
            }
        }
        
        // 为杜邦框架输入框添加实时计算
        document.getElementById('netProfitMargin').addEventListener('input', updateDupontResult);
        document.getElementById('assetTurnover').addEventListener('input', updateDupontResult);
        document.getElementById('equityMultiplier').addEventListener('input', updateDupontResult);
        
        // 添加回车键支持
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (document.activeElement.closest('.calculator-section')) {
                    if (document.getElementById('netProfitMargin').value || 
                        document.getElementById('assetTurnover').value || 
                        document.getElementById('equityMultiplier').value) {
                        analyzeDupont();
                    } else {
                        calculateAndAnalyze();
                    }
                }
            }
        });
    </script>
</body>
</html>